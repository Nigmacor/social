{% extends 'base.html' %}
{% load static %}
{% load thumbnail %}

{% block title %}
  {% if category %}{{ category.title }}{% else %}Products{% endif %}
{% endblock %}

{% block content %}
<div class="product-detail">
  {% for ans in product.category.get_ancestors %}
    <a href="{{ ans.get_absolute_url }}">{{ ans.name }}/</a>
  {% endfor %}
  <h1>{{ product.title }}</h1>
  <div class="image-container">
    <a href="{{ product.product_galary.main_image }}">
      <img src="{{ product.product_galary.main_image }}" class="image-detail">
    </a>

    {% for image in product.product_galary.images.all %}
    {% thumbnail image.image "30" as im %}
    <a href="{{ im.url }}">
      <img src="{{ im.url }}" class="image-detail">
    </a>
    {% endthumbnail %}
    {% endfor %}
  </div>
  <!-- <div style="height:200px; width: 200px; background-size:cover; background-image:url({% if product.product_galary.images %}{{ product.product_galary.main_image }}{% else %}{% static "img/fiz.png" %}{% endif %})" class="image-detail card-img-top rounded-top"></div> -->
  <div class="image-info">
    <span class="count">просмотров: {{ total_views }}</span>
  </div>
  <h2><a href="{{ product.category.get_absolute_url }}">{{ product.category }}</a></h2>
  <p class="price">${{ product.price }}</p>
  <form class="" action="{% url "cart:cart_add" product.id %}" method="post">
    {{ cart_product_form }}
    {% csrf_token %}
    <button type="submit" class="btn btn-primary">в корзину</button>
  </form>
  {{ product.body|linebreaks }}
</div>

{% endblock %}
